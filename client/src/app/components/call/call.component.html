<div class="fixed inset-0 bg-[#0A0E14] overflow-hidden" (mousemove)="showControlsTemporarily()" (touchstart)="showControlsTemporarily()">
    <!-- Remote Video (Full Screen) -->
    <div class="absolute inset-0">
        <video 
            #remoteVideo 
            autoplay 
            playsinline
            muted="false"
            class="w-full h-full object-cover"
        ></video>
        
        <!-- Overlay gradient for better text visibility -->
        <div class="absolute inset-0 bg-linear-to-b from-black/40 via-transparent to-black/60 pointer-events-none"></div>
    </div>

    <!-- Local Video (Picture-in-Picture) -->
    <div class="absolute top-4 right-4 md:top-6 md:right-6 z-10">
        <div class="relative group">
            <video 
                #localVideo 
                autoplay 
                playsinline 
                muted
                class="w-28 h-20 md:w-48 md:h-36 rounded-xl md:rounded-2xl object-cover ring-2 ring-white/20 shadow-2xl"
                [class.opacity-0]="!callState().isVideoEnabled"
            ></video>
            
            <!-- Camera off overlay -->
            @if (!callState().isVideoEnabled) {
                <div class="absolute inset-0 bg-linear-to-br from-[#5FCDD9]/20 to-[#04BF9D]/20 backdrop-blur-xl rounded-xl md:rounded-2xl flex items-center justify-center ring-2 ring-white/20">
                    <div class="text-center">
                        <div class="w-8 h-8 md:w-12 md:h-12 mx-auto mb-1 md:mb-2 rounded-full bg-white/10 flex items-center justify-center">
                            <svg class="w-4 h-4 md:w-6 md:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <p class="text-white text-[10px] md:text-xs font-medium">Camera Off</p>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Top Bar (Call Info) -->
    <div class="absolute top-0 left-0 right-0 z-20 transition-all duration-300"
         [class.translate-y-0]="showControls()"
         [class.-translate-y-full]="!showControls()">
        <div class="p-3 md:p-6">
            <div class="backdrop-blur-xl bg-black/40 rounded-xl md:rounded-2xl border border-white/10 p-3 md:p-4">
                <div class="flex items-center justify-between">
                    <!-- Contact Info -->
                    <div class="flex items-center gap-2 md:gap-4">
                        @if (getContactInfo()?.picture) {
                            <img [src]="getContactInfo()!.picture" [alt]="getContactInfo()!.name" class="w-10 h-10 md:w-12 md:h-12 rounded-full ring-2 ring-white/20">
                        } @else {
                            <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-linear-to-br from-[#5FCDD9] to-[#04BF9D] flex items-center justify-center ring-2 ring-white/20">                   
                                <span class="text-lg md:text-xl font-bold text-white">{{ getContactInfo()?.name?.[0] }}</span>
                            </div>
                        }
                        <div>
                            <h2 class="text-white font-semibold text-sm md:text-lg">{{ getContactInfo()?.name }}</h2>
                            <div class="flex items-center gap-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                <p class="text-gray-300 text-xs md:text-sm">{{ callDuration() }}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Connection Quality -->
                    <div class="hidden md:flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-green-400 text-sm font-medium">Excellent</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Controls -->
    <div class="absolute bottom-0 left-0 right-0 z-20 transition-all duration-300"
         [class.translate-y-0]="showControls()"
         [class.translate-y-full]="!showControls()">
        <div class="p-3 md:p-6">
            <div class="max-w-2xl mx-auto">
                <div class="backdrop-blur-xl bg-black/40 rounded-2xl md:rounded-3xl border border-white/10 p-4 md:p-6">
                    <div class="flex items-center justify-center gap-3 md:gap-4">
                        
                        <!-- Mute Button -->
                        <button 
                            (click)="toggleMute()"
                            [class.bg-white-10]="!callState().isMuted"
                            [class.bg-red-500]="callState().isMuted"
                            class="group p-4 md:p-5 rounded-xl md:rounded-2xl transition-all active:scale-95 touch-manipulation">
                            @if (callState().isMuted) {
                                <svg class="w-6 h-6 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"/>
                                </svg>
                            } @else {
                                <svg class="w-6 h-6 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                                </svg>
                            }
                        </button>

                        <!-- Video Toggle Button -->
                        <button 
                            (click)="toggleVideo()"
                            [class.bg-white-10]="callState().isVideoEnabled"
                            [class.bg-red-500]="!callState().isVideoEnabled"
                            class="group p-4 md:p-5 rounded-xl md:rounded-2xl transition-all active:scale-95 touch-manipulation">
                            @if (callState().isVideoEnabled) {
                                <svg class="w-6 h-6 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                </svg>
                            } @else {
                                <svg class="w-6 h-6 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
                                </svg>
                            }
                        </button>

                        <!-- End Call Button -->
                        <button 
                            (click)="endCall()"
                            class="p-5 md:p-6 bg-red-500 hover:bg-red-600 active:bg-red-700 rounded-xl md:rounded-2xl transition-all active:scale-95 shadow-lg shadow-red-500/50 touch-manipulation">
                            <svg class="w-7 h-7 md:w-8 md:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z"/>
                            </svg>
                        </button>

                        <!-- Fullscreen Button (Hidden on Mobile) -->
                        <button 
                            (click)="toggleFullscreen()"
                            class="hidden md:block p-5 bg-white/10 rounded-2xl transition-all active:scale-95 touch-manipulation">
                            @if (isFullscreen()) {
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"/>
                                </svg>
                            } @else {
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/>
                                </svg>
                            }
                        </button>
                    </div>

                    <!-- Control Labels -->
                    <div class="flex items-center justify-center gap-3 md:gap-4 mt-3 md:mt-4">
                        <span class="text-white/60 text-[10px] md:text-xs w-14 md:w-16 text-center">{{ callState().isMuted ? 'Unmute' : 'Mute' }}</span>
                        <span class="text-white/60 text-[10px] md:text-xs w-14 md:w-16 text-center">{{ callState().isVideoEnabled ? 'Video' : 'Video' }}</span>
                        <span class="text-red-400 text-[10px] md:text-xs w-16 md:w-20 text-center font-semibold">End Call</span>
                        <span class="hidden md:block text-white/60 text-xs w-16 text-center">{{ isFullscreen() ? 'Exit' : 'Full' }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Call Stats (Optional - Top Left) -->
    @if (showControls()) {
        <div class="absolute top-4 left-4 md:top-6 md:left-6 z-10">
            <div class="backdrop-blur-xl bg-black/40 rounded-lg md:rounded-xl border border-white/10 px-3 py-2 md:px-4">
                <div class="flex items-center gap-2 md:gap-3">
                    <div class="flex items-center gap-1.5 md:gap-2">
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span class="text-white text-xs md:text-sm font-medium">HD</span>
                    </div>
                    <div class="w-px h-3 md:h-4 bg-white/20"></div>
                    <span class="text-white/60 text-[10px] md:text-xs">1.2 Mbps</span>
                </div>
            </div>
        </div>
    }
</div>
